% Compile with XeLaTeX, TeXLive 2013 or more recent
\input{common/config}

\title{Анализ зависимостей}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\section*{Обзор}

\begin{frame}{На прошлой лекции}
\end{frame}

\begin{frame}{На этой лекции}
\tableofcontents
\end{frame} 

\section{Виды зависимостей}

\begin{frame}{Зависимости по данным}
Виды зависимостей по данным:

\begin{itemize}
    \item Зависимость по выходным данным,
    \item Антизависимость,
    \item Истинная зависимость.
\end{itemize}
\end{frame}

\begin{frame}

\begin{itemize}
  \item RAW
  \item RAR
  \item WAW
  \item WAR
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Зависимость по выходным данным}
\begin{lstlisting}
x = 2 * y + 5;
x = 3 + k;
\end{lstlisting}

Мешает ли распараллеливанию?

\pause

\begin{lstlisting}
x1 = 2 * y + 5;
x2 = 3 + k;
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Антизависимость}
\begin{lstlisting}
x = 2 * y + 1
y = z + 2
\end{lstlisting}

Мешает ли распараллеливанию?

\pause

\begin{lstlisting}
y1 = y
x = 2 * y1 + 1
y = z + 2
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Истинная зависимость}
\begin{lstlisting}
x = 2 + z
y = 4 + x
\end{lstlisting}

\pause\bigskip

Мешает ли распараллеливанию?

\pause\bigskip

Да
\end{frame}

\begin{frame}[fragile]

\begin{lstlisting}
for (i = 0; i < M; ++i) {
  a[i] = f(a[i])
}
\end{lstlisting}

можно распараллелить на $M$ потоков.

\end{frame}

\begin{frame}[fragile]

\begin{lstlisting}
for (i = 0; i < M - 1; ++i) {
  a[i] = f(a[i + 1]);
}
\end{lstlisting}

антизависимость $=>$ можно распараллелить на $M$.

\end{frame}

\begin{frame}[fragile]

\begin{lstlisting}
for (i = 1; i < M; ++i) {
  a[i] = f(a[i-1]);
}
\end{lstlisting}

нельзя распараллелить

\end{frame}

\begin{frame}[fragile]

\begin{lstlisting}
for (i = 0; i < M; ++i) {
  a[i] = f(a[i - 2]);
}
\end{lstlisting}

можно распараллелить на два потока

\end{frame}

\begin{frame}[fragile]

\begin{lstlisting}
do {
  A[f(k)] = ...;
  ... = A[g(l)];
}
\end{lstlisting}

Если $f(k) == g(l)$, то распараллелить нельзя, так как производится чтение и запись одного и того же элемента.

\end{frame}

\begin{frame}[fragile]

Для того, чтоб узнать, можно ли распараллелить цикл необходимо вычислить

$D = K - L$

\begin{lstlisting}
for (i = 0; i < M; ++i) {
  a[i] = f(a[i+1]);
}
\end{lstlisting}

Разворачиваем цикл

\begin{itemize}
  \item \texttt{a[1] = f(a[2])}
  \item \texttt{a[2] = f(a[3])}
\end{itemize}

D = -1 $=>$ в цикле есть антизависимость и от нее можно избавиться копирование данных

\end{frame}

\section*{Конец}
% The final "thank you" frame 

\begin{frame}{Задания}
\end{frame}

\begin{frame}{На следующей лекции}
\end{frame}

\begin{frame}

{\huge{Спасибо за внимание!}\par}

\vfill

\tiny{\textit{Замечание}: все торговые марки и логотипы, использованные в данном материале, являются собственностью их владельцев. Представленная здесь точка зрения отражает личное мнение автора, не выступающего от лица какой-либо организации.}

\end{frame}

\end{document}
